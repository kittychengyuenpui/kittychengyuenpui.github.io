import{a}from"./chunk-Cv_h2SVa.js";import{l as e}from"./chunk-D3YcvhA7.js";import{u as s,f as t}from"./chunk-BMWAGNo5.js";import{s as l}from"./chunk-BqjzUA-v.js";import{a6 as r,r as n,o as i,w as o,aR as m,W as c,X as u,U as p,F as h,a_ as k,a3 as v,be as d,u as g}from"./chunk-BB7IEB5B.js";import"./chunk-CShO9xrd.js";import"./chunk-DyqAhB7D.js";import"./chunk-B8dymozY.js";import"./chunk-BP0RZxjf.js";import"./chunk-yaJDdhye.js";import"./chunk-DorFIKXF.js";import"./chunk-Brhz0LsG.js";import"./chunk-DCTqbsaT.js";import"./chunk-C6Zwkpkb.js";import"./chunk-BLnK4V6m.js";import"./chunk-Q9bklZT_.js";import"./chunk-iVZSWji-.js";import"./chunk-6OeFQMrk.js";import"./chunk-D6zm6W2C.js";import"./chunk-Cjrd7Wf_.js";import"./chunk-Dq6ymT-8.js";const j={class:"toast toast-top toast-end"},f={key:0,class:"alert alert-error"},b={key:1,class:"alert alert-success"},y={key:2,class:"alert alert-error"},w={class:""},I={for:"explore"},x=["accept"],C={class:"p-0"},S={class:"flex items-center gap-8"},_={class:"avatar h-14"},q={class:"w-12 h-12 mask mask-squircle hover:w-14 hover:h-14"},L={class:"w-64"},T={class:"overflow-hidden font-bold whitespace-nowrap text-ellipsis"},U=["onClick"],D=r({__name:"ImageConfig",setup(r){const D=s().globalConfig,{getImageList:F}=l(D),N=n("image/*"),R=n(0),W=e.createInstance({name:"imgStore"}),X=async e=>{if(!/image*/.test(e.target.files[0].type))return void(R.value=3);let{dataUrl:s,fileName:t}=await a(e.target.files[0]);W.setItem((new Date).getTime().toString()+"+"+t,s).then((()=>{R.value=1,z()})).catch((()=>{R.value=2}))},z=async()=>{(await W.keys()).length>0&&W.iterate(((a,e)=>{D.addImage({id:e,name:e,url:"Storage"})}))};return i((()=>{})),o((()=>R.value),(a=>{0!==a&&setTimeout((()=>{R.value=0}),2e3)})),(a,e)=>(m(),c(h,null,[u("div",j,[2==R.value?(m(),c("div",f,e[0]||(e[0]=[u("span",null,"上傳失敗",-1)]))):p("",!0),1==R.value?(m(),c("div",b,e[1]||(e[1]=[u("span",null,"上傳成功",-1)]))):p("",!0),3==R.value?(m(),c("div",y,e[2]||(e[2]=[u("span",null,"不是圖片",-1)]))):p("",!0)]),u("div",null,[u("div",w,[u("label",I,[u("input",{type:"file",class:"",id:"explore",style:{display:"none"},onChange:X,accept:N.value},null,40,x),e[3]||(e[3]=u("span",{class:"btn btn-primary btn-sm"},"上傳圖片",-1))])]),u("ul",C,[(m(!0),c(h,null,k(g(F),(a=>(m(),c("li",{key:a.id,class:"mb-3"},[u("div",S,[u("div",_,[u("div",q,[v(t,{imgItem:a},null,8,["imgItem"])])]),u("div",L,[u("div",T,d(a.name),1)]),u("div",null,[u("button",{class:"btn btn-error btn-xs",onClick:e=>(a=>{"Storage"==a.url&&W.removeItem(a.id).then((()=>{D.removeImage(a.id)})),D.removeImage(a.id)})(a)},"删除",8,U)])])])))),128))])])],64))}});export{D as default};
